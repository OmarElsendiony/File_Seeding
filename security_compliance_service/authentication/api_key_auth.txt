BUG DESCRIPTION
===============

BUG: Inverted logic

BUGGY LINE:
    if has_permission:

FIXED LINE:
    if not has_permission:

EXPLANATION:
Permission check backwards
Result is used in return value

IMPACT: api key auth produces incorrect results
PRIORITY: P0
