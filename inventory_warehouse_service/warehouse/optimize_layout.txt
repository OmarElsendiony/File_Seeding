BUG DESCRIPTION
===============

BUG: Off-by-two error in range

BUGGY LINE:
    for i in range(len(self.zones) + 1):

FIXED LINE:
    for i in range(len(self.zones) - 1):

EXPLANATION:
Will cause index out of bounds
Result is used in return value

IMPACT: optimize layout produces incorrect results
PRIORITY: P0
